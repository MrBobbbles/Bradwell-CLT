{% include 'layouts/admin_header.html' %}
<h1>Admin View</h1>

<h2>Edit Person</h2>

<form action="{{ url_for('admin.edit_person', person_id=person.id) }}" method="POST" enctype="multipart/form-data" style="max-width: 700px; margin: 0 auto;">
  <div style="margin-bottom: 1rem;">
    <label for="name">Name:</label><br>
    <input type="text" name="name" id="name" required class="form-control" style="width: 100%; padding: 0.5rem;" value="{{ person.name }}" />
  </div>

  <div style="margin-bottom: 1rem;">
    <label for="role">Role:</label><br>
    <input type="text" name="role" id="role" required class="form-control" style="width: 100%; padding: 0.5rem;" value="{{ person.role }}" />
  </div>

  <div style="margin-bottom: 1rem;">
    <label for="image">Upload Image:</label><br>
    <input type="file" name="image" id="image" class="form-control" />
  </div>

  <h3>Information Blocks</h3>
  <div id="info-container">
    {% for info in person.infos %}
    <div class="info" data-index="{{ loop.index0 }}" style="margin-bottom: 1rem;">
      <label for="infos[{{ loop.index0 }}]">Info:</label>
      <input type="text" name="infos[{{ loop.index0 }}]" class="form-control" style="width: 100%; padding: 0.5rem;" value="{{ info.text }}" />
    </div>
    {% endfor %}
  </div>

  <button type="button" onclick="addInfo()" class="btn btn-secondary">Add Info</button>
  <button type="submit" class="btn btn-primary">Save Changes</button>
</form>

<script>
let infoIndex = {{ person.infos|length }};

function addInfo() {
  const container = document.getElementById('info-container');
  const div = document.createElement('div');
  div.classList.add('info');
  div.setAttribute('data-index', infoIndex);

  div.innerHTML = `
    <label for="infos[${infoIndex}]">Info:</label>
    <input type="text" name="infos[${infoIndex}]" class="form-control" style="width: 100%; padding: 0.5rem; margin-bottom: 10px;" />
  `;

  container.appendChild(div);
  infoIndex++;
}
</script>

{% include 'layouts/admin_footer.html' %}
